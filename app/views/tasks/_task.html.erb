<div id="task-panel-<%=task.id%>">
  <% panel_type = "panel " %>
  <!-- Incoming excessive view logic! -->
  <!-- Not handled in controller/model because Ajax -->
  <% if task.completed %>
    <% panel_type += "panel-success" %>
  <% else %>
    <% if task.due_on && (task.due_on - Date.today <= 1) %>
      <% panel_type += task.due_on < Date.today ? "panel-danger":"panel-warning"%>
    <% else %>
      <% panel_type += "panel-primary" %>
    <% end %>
  <% end %>

  <div class="<%= panel_type %>" data-id="<%= task.id %>">
    <div class="panel-heading">
      <h3 class="panel-title"><%= task.name %></h3>
    </div>
    <div class="panel-body">
      <p><%= truncate task.description, length: 50 %></p>
      <% if task.due_on %>
        <p id="complete-by">Complete by: <%= task.due_on %></p>
      <% end %>

        <p>Status: <%= task.completed ? "Complete":"Incomplete"%></p>
        <% btn_text = task.completed ? ("Wait, I'm Not Done!"):("I'm Done!")%>
        <%= link_to btn_text, task_path(id: task.id, task: { completed: !task.completed}), method: :patch, remote: true, class: "btn btn-primary btn-sm outline" %>
    </div>
  </div>
</div>
